# Chapter 11  Regular expressions

* **`import re`** : import the regular expression library before using it

* **`re.search()` function**

```python
# search for lines that contain 'From'
import re
hand = open('mbox-short.txt') 
for line in hand:
    line = line.rstrip()
    if re.search('From:', line):
        print(line)
```

* `line.find()` can do the same result

```python
hand = open('mbox-short.txt')
for line in hand:
    line = line.rstrip()
    if line.find('From:') >= 0:
        print(line)
```

* `re.search()` allow us to do sophisticated matching when we add special characters
   * `^` caret character: match the start of the line

```python
import re
hand = open('mbox-short.txt')
for line in hand:
    line = line.rstrip()
    if re.search('^From:', line):
        print(line)
```  

* `line.startswith()` can do the same result

```python
hand = open('mbox-short.txt')
for line in hand:
    line = line.rstrip()
    if line.startswith('From:'):
        print(line)
```

## 11.1 Character matching in regular expressions

* `.` dot or period or full stop character: match any character
   * `F..m:`: 'From:', 'F12m:', 'F!@m:' ...

```python
# search for lines that start with 'F', followed by 2 characters, followed by 'm:'
import re
hand = open('mbox-short.txt') 
for line in hand:
    line = line.rstrip()
    if re.search('^F..m:', line):
        print(line)
```

*  `*` or `+` characters: a character can be repeated any number of times
*  `.+` or `.*` : one or more characters

```python
import re
hand = open('mbox-short.txt')
for line in hand:
    line = line.rstrip()
    if re.search('^From:.+@', line):
        print(line)
```

* Regular expression quick guide

| character | meaning|
| :--------:| :---- |
| `^`       | Matches the **beginning** of a line|
| `$`       | Matches the **end** of the line |
| `.`       | Matches **any** character |
| `\s`      | Matches **whitespace** |
| `\S`      | Matches any **non-whitespace** character |
| `*`       | **Repeats** a character zero or more times |
| `*?`      | **Repeats** a character zero or more times (non-greedy) |
| `+`       | **Repeats** a character one or more times |
| `+?`      | **Repeats** a character one or more times (non-greedy) |
| `[aeiou]` | Matches a single character in the listed **set** |
| `[^XYZ]`  | Matches a single character **not in** the listed **set** |
| `[a-zA-Z0-9]`| The set of characters can include a **range** |
| `(`       | Indicates where string **extraction** is to start |
| `)`       | Indicates where string **extraction** is to end |


## 11.2 Extracting data using regular expressions

* `re.findall()` method

```python
import re
s = 'A message from csev@umich.edu to cwen@iupui.edu about meeting @2PM'
lst = re.findall('\S+@\S+', s)
print(lst)

['csev@umich.edu', 'cwen@iupui.edu']
```

```python
import re
hand = open('mbox-short.txt') 
for line in hand:
    line = line.rstrip()
    x = re.findall('[a-zA-Z0-9]\S+@\S+[a-zA-Z]', line) 
    if len(x) > 0:
        print(x)
```

* `[0-9]+` : one or more digits

```python
>>> import re
>>> x = 'My 2 favorite numbers are 19 and 42'
>>> y = re.findall('[0-9]+', x)
>>> print(y)
['2', '19', '42']
>>> y = re.findall('[AEIOU]+', x)
>>> print(y)
[]

```


## 11.3 Combining searching and extracting


## 11.4 Escape character


## 11.5 Summary


## 11.6 Bonus section for Unix / Linux users


## 11.7 Debugging


## 11.8 Glossary

* **brittle code** Code that works when the input data is in a particular format but is prone to breakage if there is some deviation from the correct format. We call this “brittle code” because it is easily broken.

* **greedy matching** The notion that the + and * characters in a regular expression expand outward to match the largest possible string.

* **grep** A command available in most Unix systems that searches through text files looking for lines that match regular expressions. The command name stands for “Generalized Regular Expression Parser”.

* **regular expression** A language for expressing more complex search strings. A regular expression may contain special characters that indicate that a search only matches at the beginning or end of a line or many other similar capa- bilities.

* **wild card** A special character that matches any character. In regular expressions the wild-card character is the period.


## 11.9 Exercises

**Exercise 1: Write a simple program to simulate the operation of the grep command on Unix. Ask the user to enter a regular expression and count the number of lines that matched the regular expression:**

$ python grep.py    
Enter a regular expression: ^Author    
mbox.txt had 1798 lines that matched ^Author

$ python grep.py    
Enter a regular expression: ^X-    
mbox.txt had 14368 lines that matched ^X-  

$ python grep.py
Enter a regular expression: java$
mbox.txt had 4175 lines that matched java$


**Exercise 2: Write a program to look for lines of the form:**

New Revision: 39772

**Extract the number from each of the lines using a regular expression and the findall() method. Compute the average of the numbers and print out the average as an integer.**

Enter file:mbox.txt   
38549

Enter file:mbox-short.txt    
39756
